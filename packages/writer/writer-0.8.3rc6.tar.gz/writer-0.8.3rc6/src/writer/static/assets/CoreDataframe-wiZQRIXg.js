function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./index-5u5REPT4.js","./serialization-DJC7NP0N.js","./Arrow.dom-GBJpMYQS.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{d as O,r as C,o as s,e as f,s as G,q as ve,t as Z,y as oe,R as ne,_ as U,G as $,b as L,am as Oe,f as B,c,an as Me,ao as Ge,N as F,L as T,x as me,Y as te,ac as Ze,af as _e,K as N,ai as Le,i as ce,a as fe,w as ee,k as Ue,Q as Je,m as Ce,ad as Ye,n as Ie,ap as Qe,l as $e,v as He,W as qe,aq as k,ar as Pe,F as ae,as as ze,at as Ke,au as ea,av as aa,aw as ta,ax as na,ay as oa,z as Aa,A as ra}from"./index-BEZl8isL.js";import la from"./BaseDropdown-BzQ2P46q.js";import"./useFocusWithin-D9cSjn1O.js";const sa=["tabindex"],ia=["value"],da=O({__name:"CoreDataframeCellNumber",props:{value:{validator:e=>typeof e=="number"||typeof e=="bigint",required:!0},editable:{type:Boolean,required:!1}},emits:{change:e=>typeof e=="string"},setup(e,{emit:n}){const o=e,l=n,v=C(),r=C(),t=C(!1);async function p(){if(!o.editable)return!1;t.value=!0,await ne(),r.value.focus()}function R(){t.value=!1,Number(r.value.value)!==o.value&&l("change",r.value.value)}return(I,_)=>(s(),f("div",{ref_key:"wrapper",ref:v,class:oe(["CoreDataframeCellNumber",{"CoreDataframeCellNumber--editable":e.editable}]),tabindex:e.editable&&!t.value?0:-1,onFocusin:p,onClick:p},[t.value?(s(),f("input",{key:0,ref_key:"input",ref:r,type:"number",value:e.value,onFocusout:R},null,40,ia)):(s(),f(G,{key:1},[ve(Z(e.value),1)],64))],42,sa))}}),ua=U(da,[["__scopeId","data-v-ce69dacd"]]),ca=["tabindex"],fa=["value"],ma=O({__name:"CoreDataframeCellText",props:{value:{validator:()=>!0,required:!0},useMarkdown:{type:Boolean,required:!1},editable:{type:Boolean,required:!1}},emits:{change:e=>typeof e=="string"},setup(e,{emit:n}){const o=e,l=n,v=C(),r=C(),t=C(!1),p=C();async function R(){var _;if(!o.editable)return!1;p.value=((_=v.value)==null?void 0:_.getBoundingClientRect().height)-16-1,t.value=!0,await ne(),r.value.focus()}function I(){t.value=!1,r.value.value!==o.value&&l("change",r.value.value)}return(_,w)=>(s(),f("div",{ref_key:"wrapper",ref:v,class:oe(["CoreDataframeCellText",{"CoreDataframeCellText--editable":e.editable}]),tabindex:e.editable&&!t.value?0:-1,onFocusin:R,onClick:R},[t.value?(s(),f("textarea",{key:0,ref_key:"textarea",ref:r,value:String(e.value),style:$({height:p.value?`${p.value}px`:"auto"}),onFocusout:I},null,44,fa)):(s(),f(G,{key:1},[e.useMarkdown?(s(),L(Oe,{key:0,"raw-text":String(e.value)},null,8,["raw-text"])):(s(),f(G,{key:1},[ve(Z(e.value),1)],64))],64))],42,ca))}}),va=U(ma,[["__scopeId","data-v-ac09b769"]]),wa=["checked","readonly","tabindex"],pa=O({__name:"CoreDataframeCellBoolean",props:{value:{type:Boolean,required:!0},editable:{type:Boolean,required:!1}},emits:{change:e=>typeof e=="boolean"},setup(e,{emit:n}){const o=e,l=n;function v(r){if(!o.editable){r.preventDefault(),r.stopPropagation();return}l("change",r.target.checked)}return(r,t)=>(s(),f("div",{class:oe(["CoreDataframeCellBoolean",{"CoreDataframeCellBoolean--disabled":!e.editable}])},[B("input",{type:"checkbox",checked:e.value,readonly:!e.editable,tabindex:e.editable?0:-1,onChange:v},null,40,wa)],2))}}),ya=U(pa,[["__scopeId","data-v-29cadcfd"]]),ba={class:"CoreDataframeCellUnknown"},ha=O({__name:"CoreDataframeCellUnknown",props:{value:{validator:()=>!0,required:!0}},setup(e){const n=e,o=c(()=>JSON.stringify(n.value,Me));return(l,v)=>(s(),f("div",ba,Z(o.value),1))}}),ga=U(ha,[["__scopeId","data-v-f172f71d"]]),Ca=O({__name:"CoreDataframeCell",props:{value:{validator:()=>!0,required:!0},useMarkdown:{type:Boolean,required:!1},editable:{type:Boolean,required:!1}},emits:{change:e=>e!==void 0},setup(e){const n=e,o=c(()=>{switch(typeof n.value){case"number":case"bigint":return ua;case"boolean":return ya;case"string":return va;default:return ga}});return(l,v)=>(s(),L(Ge(o.value),{value:e.value,"use-markdown":e.useMarkdown,editable:e.editable,onChange:v[0]||(v[0]=r=>l.$emit("change",r))},null,40,["value","use-markdown","editable"]))}}),D="__internal_arquero_id",Ia="data:application/vnd.apache.arrow.file;base64,QVJST1cxAAD/////iAMAABAAAAAAAAoADgAGAAUACAAKAAAAAAEEABAAAAAAAAoADAAAAAQACAAKAAAAlAIAAAQAAAABAAAADAAAAAgADAAEAAgACAAAAGwCAAAEAAAAXwIAAHsiaW5kZXhfY29sdW1ucyI6IFsiX19pbmRleF9sZXZlbF8wX18iXSwgImNvbHVtbl9pbmRleGVzIjogW3sibmFtZSI6IG51bGwsICJmaWVsZF9uYW1lIjogbnVsbCwgInBhbmRhc190eXBlIjogInVuaWNvZGUiLCAibnVtcHlfdHlwZSI6ICJvYmplY3QiLCAibWV0YWRhdGEiOiB7ImVuY29kaW5nIjogIlVURi04In19XSwgImNvbHVtbnMiOiBbeyJuYW1lIjogImNvbF9hIiwgImZpZWxkX25hbWUiOiAiY29sX2EiLCAicGFuZGFzX3R5cGUiOiAiaW50NjQiLCAibnVtcHlfdHlwZSI6ICJpbnQ2NCIsICJtZXRhZGF0YSI6IG51bGx9LCB7Im5hbWUiOiAiY29sX2IiLCAiZmllbGRfbmFtZSI6ICJjb2xfYiIsICJwYW5kYXNfdHlwZSI6ICJpbnQ2NCIsICJudW1weV90eXBlIjogImludDY0IiwgIm1ldGFkYXRhIjogbnVsbH0sIHsibmFtZSI6IG51bGwsICJmaWVsZF9uYW1lIjogIl9faW5kZXhfbGV2ZWxfMF9fIiwgInBhbmRhc190eXBlIjogImludDY0IiwgIm51bXB5X3R5cGUiOiAiaW50NjQiLCAibWV0YWRhdGEiOiBudWxsfV0sICJjcmVhdG9yIjogeyJsaWJyYXJ5IjogInB5YXJyb3ciLCAidmVyc2lvbiI6ICIxMi4wLjAifSwgInBhbmRhc192ZXJzaW9uIjogIjEuNS4zIn0ABgAAAHBhbmRhcwAAAwAAAIgAAABEAAAABAAAAJT///8AAAECEAAAACQAAAAEAAAAAAAAABEAAABfX2luZGV4X2xldmVsXzBfXwAAAJD///8AAAABQAAAAND///8AAAECEAAAABgAAAAEAAAAAAAAAAUAAABjb2xfYgAAAMD///8AAAABQAAAABAAFAAIAAYABwAMAAAAEAAQAAAAAAABAhAAAAAgAAAABAAAAAAAAAAFAAAAY29sX2EAAAAIAAwACAAHAAgAAAAAAAABQAAAAAAAAAD/////6AAAABQAAAAAAAAADAAWAAYABQAIAAwADAAAAAADBAAYAAAAMAAAAAAAAAAAAAoAGAAMAAQACAAKAAAAfAAAABAAAAACAAAAAAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAAAAAAAAAAAAMAAAACAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAAAAAAAwAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAD/////AAAAABAAAAAMABQABgAIAAwAEAAMAAAAAAAEADwAAAAoAAAABAAAAAEAAACYAwAAAAAAAPAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAACgAMAAAABAAIAAoAAACUAgAABAAAAAEAAAAMAAAACAAMAAQACAAIAAAAbAIAAAQAAABfAgAAeyJpbmRleF9jb2x1bW5zIjogWyJfX2luZGV4X2xldmVsXzBfXyJdLCAiY29sdW1uX2luZGV4ZXMiOiBbeyJuYW1lIjogbnVsbCwgImZpZWxkX25hbWUiOiBudWxsLCAicGFuZGFzX3R5cGUiOiAidW5pY29kZSIsICJudW1weV90eXBlIjogIm9iamVjdCIsICJtZXRhZGF0YSI6IHsiZW5jb2RpbmciOiAiVVRGLTgifX1dLCAiY29sdW1ucyI6IFt7Im5hbWUiOiAiY29sX2EiLCAiZmllbGRfbmFtZSI6ICJjb2xfYSIsICJwYW5kYXNfdHlwZSI6ICJpbnQ2NCIsICJudW1weV90eXBlIjogImludDY0IiwgIm1ldGFkYXRhIjogbnVsbH0sIHsibmFtZSI6ICJjb2xfYiIsICJmaWVsZF9uYW1lIjogImNvbF9iIiwgInBhbmRhc190eXBlIjogImludDY0IiwgIm51bXB5X3R5cGUiOiAiaW50NjQiLCAibWV0YWRhdGEiOiBudWxsfSwgeyJuYW1lIjogbnVsbCwgImZpZWxkX25hbWUiOiAiX19pbmRleF9sZXZlbF8wX18iLCAicGFuZGFzX3R5cGUiOiAiaW50NjQiLCAibnVtcHlfdHlwZSI6ICJpbnQ2NCIsICJtZXRhZGF0YSI6IG51bGx9XSwgImNyZWF0b3IiOiB7ImxpYnJhcnkiOiAicHlhcnJvdyIsICJ2ZXJzaW9uIjogIjEyLjAuMCJ9LCAicGFuZGFzX3ZlcnNpb24iOiAiMS41LjMifQAGAAAAcGFuZGFzAAADAAAAiAAAAEQAAAAEAAAAlP///wAAAQIQAAAAJAAAAAQAAAAAAAAAEQAAAF9faW5kZXhfbGV2ZWxfMF9fAAAAkP///wAAAAFAAAAA0P///wAAAQIQAAAAGAAAAAQAAAAAAAAABQAAAGNvbF9iAAAAwP///wAAAAFAAAAAEAAUAAgABgAHAAwAAAAQABAAAAAAAAECEAAAACAAAAAEAAAAAAAAAAUAAABjb2xfYQAAAAgADAAIAAcACAAAAAAAAAFAAAAAsAMAAEFSUk9XMQ==",xe=/^__index_level_[0-9]+__$/,_a={key:0,class:"CoreDataframeRow__hand"},xa={key:1,class:"cell indexCell"},Ea=O({__name:"CoreDataframeRow",props:{showIndex:{type:Boolean,required:!1},indexText:{type:[Number,String],required:!0},columns:{type:Array,required:!0},row:{type:Object,required:!0},useMarkdown:{type:Boolean,required:!1},editable:{type:Boolean,required:!1},actions:{type:Object,required:!0}},emits:{change:(e,n,o)=>typeof e=="string"&&typeof n=="number"&&o!==void 0,action:(e,n)=>typeof n=="number"&&typeof e=="string"},setup(e){const n=e,o=C(!1),l=c(()=>Object.keys(n.actions||{}).length>0);return(v,r)=>(s(),f("div",{class:"CoreDataframeRow",tabindex:"0",onMouseover:r[1]||(r[1]=t=>o.value=!0),onMouseleave:r[2]||(r[2]=t=>o.value=!1),onFocusin:r[3]||(r[3]=t=>o.value=!0)},[l.value?(s(),f("div",_a,[o.value?(s(),L(la,{key:0,options:e.actions,onSelected:r[0]||(r[0]=t=>v.$emit("action",t,e.row[F(D)]))},null,8,["options"])):T("",!0)])):T("",!0),e.showIndex?(s(),f("div",xa,Z(e.indexText),1)):T("",!0),(s(!0),f(G,null,me(e.columns,t=>(s(),L(Ca,{key:`${e.row[F(D)]}_${t}`,class:"cell",value:e.row[t],"use-markdown":e.useMarkdown,editable:e.editable,onChange:p=>v.$emit("change",t,e.row[F(D)],p)},null,8,["value","use-markdown","editable","onChange"]))),128))],32))}}),Ba=U(Ea,[["__scopeId","data-v-0d240511"]]);function Ra(e){const n=te([]),o=C(!1),l=_e();async function v(){if(!o.value){for(o.value=!0;n.value.length;){const[t,...p]=n.value;try{await e(t)}catch(R){l.error("Error during handling job",t,R)}finally{n.value=p}}o.value=!1}}function r(t){if(n.value=[...n.value,t],!o.value)return v()}return{push:r,isBusy:Ze(o)}}function ka(e,n,o,l){const v=n.at(-1).componentId,r=c(()=>e.getComponentById(v)),{push:t,isBusy:p}=Ra(R);async function R(i){switch(i.eventType){case"wf-dataframe-add":await I(...i.payload);break;case"wf-dataframe-update":await w(...i.payload);break;case"wf-dataframe-action":await _(...i.payload);break}}async function I(){const i="wf-dataframe-add",d=l.value.numRows(),x=await N(()=>import("./index-5u5REPT4.js"),__vite__mapDeps([0,1]),import.meta.url),h=x.escape(X=>X[D]===d),y=l.value.filter(h).object();if(!y)throw Error("Could not find record");const S=Wa(y),M=x.from([S]);if(l.value=l.value.concat(M).derive({[D]:()=>x.op.row_number()}),!!V(i))return new Promise(X=>{const J=new CustomEvent(i,{detail:{payload:{record:S,record_index:d},callback:X}});j(J)})}async function _(i,d){const x="wf-dataframe-action";if(!l.value)throw Error("Table is not ready");if(!V(x))return;const h=d-1;return new Promise(y=>{const S=new CustomEvent(x,{detail:{payload:{action:i,record_index:h},callback:y}});j(S)})}async function w(i,d,x){if(!l.value)throw Error("Table is not ready");if(d===void 0)throw Error("Must specify the index to update a row");const h="wf-dataframe-update",y=d-1,S=await N(()=>import("./index-5u5REPT4.js"),__vite__mapDeps([0,1]),import.meta.url),M=S.escape(W=>W[D]===d),X=l.value.filter(M).object();if(!X)throw Error("Could not find record");const J=X[i],Ae=Da(J,x),re=S.escape(W=>W[D]===d?Ae:W[i]);if(l.value=l.value.derive({[i]:re}),!V(h))return;const q=Sa(l.value.filter(M).object());return new Promise(W=>{const le=new CustomEvent(h,{detail:{payload:{record:q,record_index:y},callback:W}});j(le)})}function V(i){var h,y;const d=(h=r.value.handlers)==null?void 0:h[i],x=((y=r.value.binding)==null?void 0:y.eventType)==i;return!!(d||x)}function j(i){o.value instanceof HTMLElement?o.value.dispatchEvent(i):o.value.$el.dispatchEvent(i)}return{isBusy:p,handleUpdateCell:(...i)=>t({eventType:"wf-dataframe-update",payload:i}),handleAddRow:(...i)=>t({eventType:"wf-dataframe-add",payload:i}),handleActionRow:(...i)=>t({eventType:"wf-dataframe-action",payload:i})}}function Da(e,n){switch(typeof e){case"number":return Number(n);case"string":return String(n);case"boolean":return!!n;case"bigint":return BigInt(String(n));default:throw Error(`Could not update a field of type ${typeof e}`)}}function Ee(e){return e===D||xe.test(e)}function Sa(e){return Object.entries(e).filter(([n])=>!Ee(n)).reduce((n,[o,l])=>(n[o]=l,n),{})}function Wa(e){return Object.entries(e).filter(([n])=>!Ee(n)).reduce((n,[o,l])=>(n[o]=Fa(l),n),{})}function Fa(e){switch(typeof e){case"number":return 0;case"string":return"";case"boolean":return!1;case"bigint":return BigInt(0);case"object":return{};default:throw Error(`Could not get default value a field of type ${typeof e}`)}}const H=e=>(Aa("data-v-bccf7e4e"),e=e(),ra(),e),Ta=["aria-busy"],ja={key:0},Xa=H(()=>B("i",{class:"material-symbols-outlined"},"download",-1)),Va={key:0},Na={key:1,"data-writer-grid-col":"0",class:"cell headerCell indexCell"},Oa=H(()=>B("div",{class:"name"},null,-1)),Ma=H(()=>B("div",{class:"widthAdjuster"},null,-1)),Ga=[Oa,Ma],Za=["data-writer-grid-col","onClick"],La={class:"name"},Ua={class:"icon"},Ja={class:"material-symbols-outlined"},Ya=H(()=>B("div",{class:"widthAdjuster"},null,-1)),Qa={key:0,class:"CoreDataframe__newRow cell"},$a=H(()=>B("i",{class:"material-symbols-outlined"},"add",-1)),Ha="A component to display Pandas DataFrames.",qa=`
# Subscribe this event handler to the \`wf-dataframe-update\` event
#
# more on : https://dev.writer.com/framework/dataframe
def on_record_change(state, payload):
    state['mydf'].record_update(payload) # should contain an EditableDataFrame instance`,Pa=`
# Subscribe this event handler to the \`wf-dataframe-add\` event
#
# more on : https://dev.writer.com/framework/dataframe
def on_record_add(state, payload):
	payload['record']['sales'] = 0 # default value inside the dataframe
	state['mydf'].record_add(payload) # should contain an EditableDataFrame instance`,za=`
# Subscribe this event handler to the \`wf-dataframe-action\` event
#
# more on : https://dev.writer.com/framework/dataframe
def on_record_action(state, payload):
	# state['mydf'] should contains an EditableDataFrame instance
	record_index = payload['record_index']
	if payload['action'] == 'remove':
		state['mydf'].record_remove(payload) # should contain an EditableDataFrame instance
	if payload['action'] == 'open':
		state['record'] = state['mydf'].record(record_index) # dict representation of record`,Ka={writer:{name:"DataFrame",description:Ha,category:"Content",events:{"wf-dataframe-add":{desc:"Capture adding a row.",stub:Pa.trim()},"wf-dataframe-update":{desc:"Capture a cell change.",stub:qa.trim()},"wf-dataframe-action":{desc:"Remove or open a row.",stub:za.trim()}},fields:{dataframe:{name:"Data",desc:"Must be a state reference to a Pandas dataframe or PyArrow table. Alternatively, a URL for an Arrow IPC file.",type:k.Text,default:Ia},showIndex:{name:"Show index",desc:"Shows the dataframe's index. If an Arrow table is used, shows the zero-based integer index.",type:k.Text,default:"yes",options:{yes:"yes",no:"no"}},enableSearch:{name:"Enable search",type:k.Text,default:"no",options:{yes:"yes",no:"no"}},enableRecordAdd:{name:"Enable adding a record",type:k.Text,default:"no",options:{yes:"yes",no:"no"}},enableRecordUpdate:{name:"Enable updating a record",type:k.Text,default:"no",options:{yes:"yes",no:"no"}},enableDownload:{name:"Enable download",desc:"Allows the user to download the data as CSV.",type:k.Text,default:"no",options:{yes:"yes",no:"no"}},actions:{name:"Actions",desc:"Define rows actions",type:k.KeyValue,default:JSON.stringify({remove:"Remove",open:"Open"}),validator:Pe},useMarkdown:{name:"Use Markdown",type:k.Text,desc:"If active, the output will be sanitized; unsafe elements will be removed.",options:{yes:"yes",no:"no"},default:"no"},displayRowCount:{name:"Display row count",desc:"Specifies how many rows to show simultaneously.",type:k.Number,category:ae.Style,default:"10",validator:ze},wrapText:{name:"Wrap text",type:k.Text,category:ae.Style,desc:"Not wrapping text allows for an uniform grid, but may be inconvenient if your data contains longer text fields.",options:{yes:"yes",no:"no"},default:"no"},primaryTextColor:Ke,secondaryTextColor:ea,accentColor:aa,separatorColor:ta,dataframeBackgroundColor:{name:"Background",type:k.Color,category:ae.Style,default:na.White,applyStyleVariable:!0},fontStyle:{name:"Font style",type:k.Text,category:ae.Style,options:{normal:"normal",monospace:"monospace"},default:"normal"},cssClasses:oa}}},et=O({...Ka,__name:"CoreDataframe",setup(e){Le(a=>({"818e379a":P.value?"sticky":"unset"}));const n=1e3,o=36,l=58,v=80,r=300,t=ce(fe.evaluatedFields),p=C(),R=C(),I=C();let _=null;const w=te(null),V=te([]),j=c(()=>t.showIndex.value=="yes"),i=c(()=>t.actions.value),d=te(null),x=C(0),h=C([]);let y=null;const S=ce(fe.core),M=ce(fe.instancePath),{handleUpdateCell:X,handleAddRow:J,handleActionRow:Ae,isBusy:re}=ka(S,M,p,w),q=c(()=>ue.value||re.value),W=c(()=>{var a;return w.value?(a=w.value)==null?void 0:a.columnNames():[]}),le=c(()=>W.value.filter(a=>V.value.includes(a))),se=c(()=>W.value.filter(A=>{if(A===D)return!1;const m=V.value.includes(A),u=xe.test(A);return!(m&&u)})),we=c(()=>(j.value?1:0)+se.value.length),Y=c(()=>{var a;return((a=w.value)==null?void 0:a.numRows())??0}),P=c(()=>Y.value>n),Q=c(()=>Math.min(t.displayRowCount.value,Y.value)),pe=c(()=>Object.keys(t.actions.value||{}).length>0),Be=c(()=>t.useMarkdown.value=="yes"),Re=c(()=>t.enableRecordUpdate.value=="yes"),ie=c(()=>t.enableRecordAdd.value=="yes"),z=c(()=>{let a;return t.wrapText.value=="yes"?a=Y.value-1:a=Y.value-Q.value,Math.min(Math.ceil(x.value*a),a)}),ye=c(()=>{if(!w.value)return null;const a=P.value?z.value:0,A=P.value?Q.value:n,m=w.value.objects({offset:a,limit:A}),u=w.value.indices().slice(z.value,z.value+Q.value);return{data:m,indices:u}}),be=c(()=>{let a=pe.value?"16px ":"";return h.value.length==0?a+=`repeat(${we.value}, minmax(min-content, 1fr))`:a+=h.value.map(A=>`${Math.max(A,v)}px`).join(" "),a}),ke=c(()=>{const a=t.fontStyle.value;return{"min-height":`${(1+t.displayRowCount.value+Number(ie.value??!1))*o}px`,"max-height":`${(Q.value+1+Number(ie.value??!1))*o}px`,"font-family":a=="monospace"?"monospace":void 0,"grid-template-rows":`${o}px repeat(${Q.value}, min-content) ${l}px`}}),De=c(()=>({top:`${o*Y.value}px`}));function Se(){const a=I.value.scrollTop;x.value=a/(I.value.scrollHeight-I.value.clientHeight)}function We(){I.value.scrollTop=0}async function de(){var A;h.value=[],await ne();const a=(A=I.value)==null?void 0:A.querySelectorAll("[data-writer-grid-col]");a==null||a.forEach(m=>{const u=m,b=u.dataset.writerGridCol,{width:g}=u.getBoundingClientRect(),E=Math.min(g,r);h.value[b]=E})}function Fe(a,A){var g,E;if(a.target.classList.contains("widthAdjuster"))return;if(((g=d.value)==null?void 0:g.columnName)!==A){d.value={columnName:A,descending:!1};return}if((E=d.value)==null?void 0:E.descending){d.value=null;return}d.value={columnName:A,descending:!d.value.descending}}function Te(a){const A=a.schema.metadata.get("pandas");return A?JSON.parse(A).index_columns:[]}const ue=C(!1);async function he(){ue.value=!0;const a=await N(()=>import("./index-5u5REPT4.js"),__vite__mapDeps([0,1]),import.meta.url),{tableFromIPC:A}=await N(()=>import("./Arrow.dom-GBJpMYQS.js"),__vite__mapDeps([2,1]),import.meta.url),m=t.dataframe.value;try{const g=await(await(await fetch(m)).blob()).arrayBuffer(),E=A(g);V.value=Te(E),_=a.fromArrow(E),w.value=_.derive({[D]:()=>a.op.row_number()})}catch(u){_e().error("Couldn't load dataframe from Arrow URL.",u)}finally{ue.value=!1}}async function je(){const a=await N(()=>import("./index-5u5REPT4.js"),__vite__mapDeps([0,1]),import.meta.url),A=w.value.select(a.not(D)).toCSV(),m=document.createElement("a"),u=new Blob([A],{type:"text/csv"}),b=URL.createObjectURL(u);m.href=b,m.download="data.csv",m.click(),URL.revokeObjectURL(b)}async function Xe(){const a=await N(()=>import("./index-5u5REPT4.js"),__vite__mapDeps([0,1]),import.meta.url);if(d.value===null){w.value=w.value.unorder();return}let A;d.value.descending?A=a.desc(d.value.columnName):A=d.value.columnName,w.value=w.value.orderby(A)}async function Ve(a){const A=a.target.value;if(!A)w.value=_;else{const m=new RegExp(A,"i"),b="(d, $) => "+_.columnNames().map(E=>`aq.op.match(d.${E}, $.pattern) !== null`).join(" || "),g=await N(()=>import("./index-5u5REPT4.js"),__vite__mapDeps([0,1]),import.meta.url);w.value=_.params({pattern:m,filterS:b}).filter(b).derive({[D]:()=>g.op.row_number()})}await ne(),We()}async function ge(a){if(a.buttons!==1){y=null;return}const A=a.target;if(!p.value.contains(A))return;if(y===null&&A.classList.contains("widthAdjuster")){const Ne=A.closest(".cell");y=parseInt(Ne.dataset.writerGridCol)}else if(y===null)return;const m=I.value.querySelector(`[data-writer-grid-col="${y}"]`),u=m.querySelector(".widthAdjuster"),{width:b}=u.getBoundingClientRect(),{left:g}=m.getBoundingClientRect(),K=a.clientX-g+b/2;h.value[y]=K}return ee(t.dataframe,()=>{he()}),ee(d,async()=>{await Xe()}),ee(we,()=>{de()}),ee(t.wrapText,()=>{de()}),Ue(async()=>{await he(),document.addEventListener("mousemove",ge),R.value&&new ResizeObserver(de).observe(R.value,{box:"border-box"})}),Je(()=>{document.removeEventListener("mousemove",ge)}),(a,A)=>{var m;return s(),f("div",{ref_key:"rootEl",ref:p,class:"CoreDataframe","aria-busy":q.value},[B("div",{ref_key:"toolsEl",ref:R,class:"tools"},[F(t).enableSearch.value==="yes"?(s(),f("div",ja,[Ce(Ye,{class:"search",placeholder:"Search","left-icon":"search",onChange:Ve})])):T("",!0),F(t).enableDownload.value==="yes"?(s(),L(Qe,{key:1,title:"Download",class:"download",onClick:je},{default:Ie(()=>[Xa]),_:1})):T("",!0)],512),B("div",{ref_key:"gridContainerEl",ref:I,class:"gridContainer",onScroll:Se},[B("div",{class:oe(["grid",{scrolled:z.value>0,wrapText:F(t).wrapText.value==="yes"}]),style:$(ke.value)},[B("div",{style:$({display:"grid","grid-template-columns":be.value})},[pe.value?(s(),f("div",Va)):T("",!0),j.value?(s(),f("div",Na,Ga)):T("",!0),(s(!0),f(G,null,me(se.value,(u,b)=>{var g,E;return s(),f("div",{key:u,"data-writer-grid-col":b+(j.value?1:0),class:"cell headerCell",onClick:K=>Fe(K,u)},[B("div",La,Z(u),1),$e(B("div",Ua,[B("span",Ja,Z((g=d.value)!=null&&g.descending?"arrow_upward":"arrow_downward"),1)],512),[[He,((E=d.value)==null?void 0:E.columnName)==u]]),Ya],8,Za)}),128))],4),(s(!0),f(G,null,me((m=ye.value)==null?void 0:m.data,(u,b)=>(s(),L(Ba,{key:b,style:$({"grid-template-columns":be.value}),row:u,actions:i.value,"use-markdown":Be.value,editable:Re.value&&!q.value,columns:se.value,"show-index":j.value,"index-text":ye.value.indices[b]??le.value.map(g=>u[g]).join(", "),onAction:F(Ae),onChange:F(X)},null,8,["style","row","actions","use-markdown","editable","columns","show-index","index-text","onAction","onChange"]))),128)),ie.value?(s(),f("div",Qa,[Ce(qe,{"aria-label":"Create a new row at the end",size:"small",variant:"tertiary",onClick:F(J)},{default:Ie(()=>[$a,ve(" Add a row ")]),_:1},8,["onClick"])])):T("",!0)],6),P.value?(s(),f("div",{key:0,class:"endpoint",style:$(De.value)},null,4)):T("",!0)],544)],8,Ta)}}}),ot=U(et,[["__scopeId","data-v-bccf7e4e"]]);export{ot as default};
