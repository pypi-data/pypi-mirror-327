"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8394],{41600:function(e,n,t){t.d(n,{q:function(){return a}});var r={documentation:"https://docs.gpustack.ai/",github:"https://github.com/gpustack/gpustack",discord:"https://discord.gg/VXYJzuaqwD",site:"https://gpustack.ai/",release:"https://github.com/gpustack/gpustack/releases"};n.Z=r;var a={audioPermission:"".concat(r.documentation,"latest/user-guide/playground/audio/#provide-audio-file")}},59995:function(e,n,t){t.d(n,{U:function(){return i},Z:function(){return u}});var r=t(9532),a=t(50959);function u(){return r.Z.CancelToken.source}function i(){var e=r.Z.CancelToken.source,n=(0,a.useRef)(null);return(0,a.useEffect)((function(){return function(){n.current&&n.current.cancel()}}),[]),{updateCancelToken:function(){n.current&&n.current.cancel(),n.current=e()},cancelRequest:function(){n.current&&n.current.cancel()},getCanceltToken:function(){return n.current.token},source:e}}},93621:function(e,n,t){t.r(n),t.d(n,{default:function(){return qe}});var r=t(90228),a=t.n(r),u=t(87999),i=t.n(u),o=t(48305),l=t.n(o),c=t(49280),s=t(37963),d=t(82344),f=t(69997),p=t(57989),v=t(6555),m=t(67581),h=t(35374),x=t(54235),g=t(85885),y=t(96938),b=t(47946),w=t(82187),j=t.n(w),k=t(32699),C=t.n(k),R=t(50959),Z=t(94299),S=t(91082),M=t(26068),N=t.n(M),A=t(56581),_=t(58573),P=function(e){var n=(0,R.useState)({width:0,height:0}),t=l()(n,2),r=t[0],a=t[1];return(0,R.useEffect)((function(){var n=e.current;if(n){var t=new ResizeObserver((function(e){if(e[0]){var n=e[0].contentRect,t=n.width,r=n.height;a({width:t,height:r})}}));return t.observe(n),function(){t.disconnect()}}}),[e]),r},z=t(11527),T=function(e){var n=e.scaleFactor,t=void 0===n?1.2:n,r=e.maxBarCount,a=void 0===r?128:r,u=e.amplitude,i=void 0===u?40:u,o=e.maxWidth,c=e.fixedHeight,s=void 0===c||c,d=e.analyserData,f=e.width,p=e.height,v=R.useRef(null),m=R.useRef(0),h=R.useRef(!1),x=R.useRef(0),g=R.useRef(1),y=R.useRef(null),b=(0,R.useState)(f),w=l()(b,2),j=w[0],k=w[1],C=(0,R.useState)(p),Z=l()(C,2),S=Z[0],M=Z[1],N=R.useRef(null),A=P(y),_=function(e,n,t,r,u){return r+(.5*Math.sin(n/200+e)+.5)*(u-r)*(t/a)};return R.useEffect((function(){A&&(k(o?Math.min(A.width,o):(null==A?void 0:A.width)||0),s||M((null==A?void 0:A.height)||0))}),[A,o]),(0,R.useEffect)((function(){var e,n;if(v.current){var r=function(){if(v.current){var e=v.current.getContext("2d");e&&e.clearRect(0,0,2*j,2*S)}};return null!==(e=d.data)&&void 0!==e&&e.length&&null!==(n=d.analyser)&&void 0!==n&&n.current?(function(){var e;if(v.current&&null!==(e=d.data)&&void 0!==e&&e.length){var n=v.current,r=n.getContext("2d");if(r){var u=n.width=2*j,o=n.height=2*S;h.current||(r.scale(2,2),h.current=!0);var l=Math.floor(o/2),c=i,s=0,f=r.createLinearGradient(0,0,0,o);f.addColorStop(0,"#007BFF"),f.addColorStop(1,"#0069DA"),r.fillStyle=f,function e(n){var i;if(n-s<16)m.current=requestAnimationFrame(e);else{s=n,null===(i=d.analyser)||void 0===i||null===(i=i.current)||void 0===i||i.getByteFrequencyData(d.data),r.clearRect(0,0,u,o);var f=Math.min(a,d.data.length),p=u/2-(10*f-6)/2+x.current;x.current+=g.current,Math.abs(x.current)>20&&(g.current*=-1);for(var v=0;v<f;v++){var h=Math.floor(d.data[v]/2)*t,y=_(v,n,h,10,c),b=h+Math.round(y),w=Math.round(l-b/2),j=Math.round(l+b/2);r.beginPath(),r.moveTo(p,j),r.lineTo(p,w+2),r.arcTo(p+4,w+2,p+4,j,2),r.lineTo(p+4,j),r.closePath(),r.fill(),p+=10}m.current=requestAnimationFrame(e)}}(performance.now())}}}(),function(){cancelAnimationFrame(m.current),r()}):(r(),cancelAnimationFrame(m.current),void(m.current=0))}}),[d,j,S]),(0,z.jsx)("div",{className:"scroller-wrapper",ref:y,style:{width:"100%",height:"100%"},children:(0,z.jsx)("div",{ref:N,className:"canvas-wrap",style:{width:"100%",height:"100%"},children:(0,z.jsx)("canvas",{ref:v,style:{display:"block"}})})})},U=R.memo(T),I=t(58258),E=t(48640),L=t(57859),F=t(95547),Y=t(69324),D=t(96247),O=t(23333),q=.5,B=2,H=.25,K=(0,R.forwardRef)((function(e,n){var t=(0,h.useIntl)(),r=e.autoplay,a=void 0!==r&&r,u=e.speed,i=void 0===u?1:u,o=R.useRef(null),c=R.useState({currentTime:0,duration:0}),s=l()(c,2),d=s[0],f=s[1],p=R.useState(!1),v=l()(p,2),m=v[0],x=v[1],y=R.useState(!1),b=l()(y,2),w=b[0],j=b[1],C=R.useState(1),Z=l()(C,2),S=Z[0],M=Z[1],N=R.useState(i),A=l()(N,2),_=A[0],P=A[1],T=R.useRef(null);(0,R.useImperativeHandle)(n,(function(){return{play:function(){var e;null===(e=o.current)||void 0===e||e.play()},pause:function(){var e;null===(e=o.current)||void 0===e||e.pause()}}}));(0,R.useCallback)((function(){j(!w)}),[w]),(0,R.useCallback)((function(e){P(e),o.current.playbackRate=e}),[]);var U=(0,R.useCallback)((function(){T.current=setInterval((function(){var e,n;f((function(e){var n,t;return{currentTime:Math.ceil((null===(n=o.current)||void 0===n?void 0:n.currentTime)||0),duration:e.duration||Math.ceil((null===(t=o.current)||void 0===t?void 0:t.duration)||0)}})),(null!==(e=o.current)&&void 0!==e&&e.paused||null!==(n=o.current)&&void 0!==n&&n.ended)&&(clearInterval(T.current),x(!1),f((function(e){var n;return{currentTime:null!==(n=o.current)&&void 0!==n&&n.ended?0:e.currentTime,duration:e.duration}})))}),500)}),[]),K=(0,R.useCallback)((function(){var e,n;(x(!m),m)?null===(e=o.current)||void 0===e||e.pause():null===(n=o.current)||void 0===n||n.play()}),[m]),G=((0,R.useCallback)((function(e){o.current.volume=(0,k.round)(e,2),M((0,k.round)(e,2))}),[]),(0,R.useCallback)((function(n){var t,r=Math.ceil((null===(t=o.current)||void 0===t?void 0:t.duration)||0);f({currentTime:0,duration:r&&r!==1/0?r:e.duration||0}),x(a)}),[a,e.duration])),V=(0,R.useCallback)((function(e){o.current.currentTime=e,f((function(n){return{currentTime:e,duration:n.duration}}))}),[]);(0,R.useCallback)((function(){var n=e.url||"",t=e.name,r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),r.remove()}),[e.url,e.name]);return(0,R.useEffect)((function(){o.current&&o.current&&(o.current.volume=S,o.current.playbackRate=_)}),[o.current]),(0,R.useEffect)((function(){return function(){clearInterval(T.current)}}),[]),(0,z.jsxs)("div",{className:"player-wrap",style:{width:e.width||"100%"},children:[(0,z.jsx)("div",{className:"player-ui",children:(0,z.jsx)("div",{className:"play-content",children:(0,z.jsxs)("div",{className:"progress-bar",children:[(0,z.jsx)("span",{className:"file-name",children:e.name}),(0,z.jsxs)("div",{className:"slider",children:[(0,z.jsxs)("span",{className:"time current",children:[" ",(0,I.mr)(d.currentTime)]}),(0,z.jsx)("div",{className:"slider-inner",children:(0,z.jsx)(D.Z,{tooltip:{open:!1},min:0,step:1,max:d.duration,value:d.currentTime,onChange:V})}),(0,z.jsx)("span",{className:"time",children:(0,I.mr)(d.duration)})]}),(0,z.jsxs)("div",{className:"controls",children:[(0,z.jsx)(O.Z,{title:t.formatMessage({id:"playground.audio.button.slow"}),children:(0,z.jsx)(g.ZP,{type:"text",size:"small",className:"backward",disabled:_===q||_<q,onClick:function(){P((function(e){if(e-H<q)return q;var n=e-H;return o.current.playbackRate=n,n}))},children:(0,z.jsx)(E.Z,{className:"font-size-20"})})}),(0,z.jsx)("span",{className:"play-btn",children:(0,z.jsx)(g.ZP,{size:"middle",type:"text",onClick:K,disabled:!(null!=d&&d.duration),icon:m?(0,z.jsx)(F.Z,{style:{fontSize:"22px"}}):(0,z.jsx)(L.Z,{style:{fontSize:"22px"}})})}),(0,z.jsx)(O.Z,{title:t.formatMessage({id:"playground.audio.button.fast"}),children:(0,z.jsx)(g.ZP,{type:"text",size:"small",className:"forward",disabled:_===B||_>B,onClick:function(){P((function(e){if(e+H>B)return B;var n=e+H;return o.current.playbackRate=n,n}))},children:(0,z.jsx)(Y.Z,{className:"font-size-20"})})})]})]})})}),(0,z.jsx)("audio",{crossOrigin:"anonymous",autoPlay:a,src:e.url,ref:o,preload:"metadata",style:{opacity:0,position:"absolute",left:"-9999px"},onPlay:U,onLoadedMetadata:G})]})})),G=R.memo(K),V=t(63417),W=t(89234),J=t(30898),$=function(e){var n,t=(0,h.useIntl)(),r=R.useCallback((function(n){var t;null===(t=e.onChange)||void 0===t||t.call(e,n)}),[]);return(0,z.jsx)(O.Z,{overlayInnerStyle:{maxWidth:290,width:"max-content"},title:t.formatMessage({id:"playground.audio.uploadfile.tips"},{formats:e.accept}),children:(0,z.jsx)(J.Z,{beforeUpload:function(e){return!1},onChange:r,accept:e.accept,multiple:!1,maxCount:1,showUploadList:!1,fileList:[],children:(0,z.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:16},children:(0,z.jsx)(g.ZP,{icon:(0,z.jsx)(W.Z,{}),type:null!==(n=e.type)&&void 0!==n?n:"text",shape:"circle"})})})})},Q=R.memo($),X=t(77470),ee=t(38780),ne=t(59995),te=function(){var e=i()(a()().mark((function e(n,t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){try{var a=new Blob([n],{type:t}),u=(0,I.hy)(a.size),i=document.createElement("audio"),o=URL.createObjectURL(a);i.src=o,i.addEventListener("loadedmetadata",(function(){var n=i.duration;e({data:a,size:u,type:t,duration:Math.ceil(n),url:o})})),i.addEventListener("ended",(function(){URL.revokeObjectURL(i.src)}))}catch(e){r(e)}})));case 1:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),re=function(){var e=i()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){var r=new FileReader;r.onload=function(){var r=i()(a()().mark((function r(u){var i,o;return a()().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,i=u.target.result,r.next=5,te(i,n.type);case 5:o=r.sent,e(N()(N()({},o||{}),{},{name:n.name})),r.next=13;break;case 9:r.prev=9,r.t0=r.catch(0),t(r.t0);case 13:case"end":return r.stop()}}),r,null,[[0,9]])})));return function(e){return r.apply(this,arguments)}}(),r.onerror=function(e){return t(e)},r.readAsArrayBuffer(n)})));case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),ae=t(77353),ue=t(54876),ie=(t(99951),t(1731)),oe=t(39121),le=(t(29031),t(76223),t(39616)),ce=t(41600),se=t(7672),de=t.n(se),fe=t(5189),pe={"audio/mpeg":"mp3","audio/mp4":"mp4","audio/wav":"wav","audio/ogg":"ogg","audio/webm":"webm","audio/aac":"aac","audio/x-flac":"flac","audio/pcm":"pcm","audio/flac":"flac","audio/x-wav":"wav","audio/L16":"pcm","audio/opus":"opus"},ve={type:"audio/mpeg",suffix:".mp3"},me=function(e){var n,t=(0,h.useIntl)(),r=(0,R.useState)(!1),u=l()(r,2),o=(u[0],u[1]),c=(0,R.useState)(!1),s=l()(c,2),d=s[0],f=s[1],p=(0,R.useState)(!0),m=l()(p,2),y=m[0],b=m[1],w=(0,R.useRef)(null),j=(0,R.useRef)(null),k=(0,R.useRef)(0),C=(0,R.useRef)(null),Z=(0,R.useRef)(null),S=(0,R.useRef)(null),M=(0,R.useRef)(""),A=(0,R.useRef)(null),_=(0,R.useRef)(null),P=(0,R.useRef)(null),T=(0,R.useRef)(null),U=(0,R.useCallback)((function(){C.current=new(window.AudioContext||window.webkitAudioContext),Z.current=C.current.createAnalyser(),Z.current.fftSize=512,S.current=new Uint8Array(Z.current.frequencyBinCount)}),[]),I=(0,R.useCallback)((function(){T.current=C.current.createMediaStreamSource(w.current),T.current.connect(Z.current)}),[]),E=(0,R.useCallback)((function(){A.current=C.current.createScriptProcessor(4096,1,1),_.current=new fe.d(1,44100,128),P.current=[],A.current.onaudioprocess=function(e){for(var n=e.inputBuffer.getChannelData(0),t=new Int16Array(n.length),r=0;r<n.length;r++)t[r]=32767*Math.max(-1,Math.min(1,n[r]));var a=_.current.encodeBuffer(t);a.length>0&&P.current.push(a)},T.current.connect(A.current),A.current.connect(C.current.destination)}),[]),L=function(){var e,n,t,r;null===(e=w.current)||void 0===e||e.getTracks().forEach((function(e){e.stop()})),null===(n=A.current)||void 0===n||n.disconnect(),null===(t=T.current)||void 0===t||t.disconnect(),null===(r=C.current)||void 0===r||r.close()},F=function(){var e;f(!1),null===(e=j.current)||void 0===e||e.stop(),L()},Y=(0,R.useCallback)((function(){var e=_.current.flush();return e.length>0&&P.current.push(e),new Blob(P.current,{type:"audio/mpeg"})}),[]),D=function(){var n=i()(a()().mark((function n(){var t;return a()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,navigator.permissions.query({name:"microphone"});case 3:"granted"===(t=n.sent).state?(b(!0),e.onAudioPermission(!0)):"denied"===t.state&&(b(!1),e.onAudioPermission(!1),F()),t.onchange=function(){D()},n.next=10;break;case 8:n.prev=8,n.t0=n.catch(0);case 10:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}(),q=function(){var e=i()(a()().mark((function e(){var n;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,null===(n=navigator.mediaDevices)||void 0===n?void 0:n.getUserMedia({audio:!0});case 3:w.current=e.sent,w.current.getAudioTracks().forEach((function(e){e.onended=function(){b(!1)}})),o(!0),b(!0),U(),I(),E(),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}(),B=function(e){var n=function(e){var n,t=e||(null===(n=j.current)||void 0===n?void 0:n.mimeType),r=ve;return Object.keys(pe).forEach((function(e){t.includes(e)&&(r={type:t,suffix:".".concat(pe[e])})})),r}(e);return"recording-".concat(de()().format("YYYY-MM-DD-HH_mm_ss")).concat(n.suffix)},H=function(){var n=i()(a()().mark((function n(){var t;return a()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!d){n.next=3;break}return r=void 0,u=void 0,null===(r=j.current)||void 0===r||r.stop(),f(!1),null===(u=e.onRecord)||void 0===u||u.call(e,!1),n.abrupt("return");case 3:return n.prev=3,n.next=6,q();case 6:URL.revokeObjectURL(M.current),j.current=new MediaRecorder(w.current),j.current.ondataavailable=function(n){var t,r;e.voiceActivity&&(null===(t=Z.current)||void 0===t||t.getByteFrequencyData(S.current),null===(r=e.onAnalyse)||void 0===r||r.call(e,S.current,Z))},j.current.onstop=i()(a()().mark((function n(){var t,r;return a()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:F(),null===(t=e.onAnalyse)||void 0===t||t.call(e,[],null),r=Y(),M.current=r.size?URL.createObjectURL(r):"",a={chunks:r,size:r.size,type:r.type,url:M.current,name:B(r.type),duration:Math.floor((Date.now()-k.current)/1e3)},u=void 0,null===(u=e.onAudioData)||void 0===u||u.call(e,a);case 5:case"end":return n.stop()}var a,u}),n)}))),f(!0),null===(t=e.onRecord)||void 0===t||t.call(e,!0),k.current=Date.now(),j.current.start(100),n.next=19;break;case 16:n.prev=16,n.t0=n.catch(3);case 19:case"end":return n.stop()}var r,u}),n,null,[[3,16]])})));return function(){return n.apply(this,arguments)}}(),K=(0,R.useMemo)((function(){return y?d?t.formatMessage({id:"playground.audio.stoprecord"}):t.formatMessage({id:"playground.audio.startrecord"}):(0,z.jsx)("span",{children:(0,z.jsxs)("span",{children:[t.formatMessage({id:"playground.audio.enablemic"}),(0,z.jsx)(g.ZP,{size:"small",color:"primary",variant:"link",href:"".concat(ce.q.audioPermission),target:"_blank",style:{paddingInline:0},children:t.formatMessage({id:"playground.audio.enablemic.doc"})})]})})}),[y,d,t]),G=(0,R.useMemo)((function(){return y?{}:{backgroundColor:"var(--ant-color-error-bg-filled-hover)",color:"var(--ant-color-error-border-hover)",border:"none"}}),[y]);return(0,R.useEffect)((function(){return function(){F(),L(),URL.revokeObjectURL(M.current)}}),[]),(0,R.useEffect)((function(){D()}),[]),(0,z.jsx)("div",{className:"audio-input",children:(0,z.jsx)(x.Z,{size:40,className:"btns",children:(0,z.jsx)(O.Z,{title:K,children:(0,z.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:16},children:(0,z.jsx)(g.ZP,{disabled:!y,shape:"circle",icon:(0,z.jsx)(v.Z,{}),size:"middle",type:null!==(n=e.type)&&void 0!==n?n:"text",style:N()({},G),danger:d,onClick:H})})})})})},he=R.memo(me),xe=t(13311),ge=t(91860),ye={language:"auto"},be=(0,R.forwardRef)((function(e,n){var t,r,u=(0,h.useIntl)(),o=e.modelList,s=(0,R.useRef)(0),d=(0,R.useState)([]),f=l()(d,2),p=f[0],v=f[1],m=(0,h.useSearchParams)(),x=l()(m,1)[0],y=x.get("type")||"",b=x.get("model")?"stt"===y&&x.get("model"):"",w=(0,R.useState)({}),k=l()(w,2),C=k[0],Z=k[1],M=(0,R.useState)(!1),P=l()(M,2),T=P[0],I=P[1],E=(0,R.useState)(!1),L=l()(E,2),F=L[0],Y=L[1],D=(0,R.useState)(null),q=l()(D,2),B=q[0],H=q[1],K=(0,R.useState)(!1),W=l()(K,2),J=W[0],$=W[1],te=(0,R.useRef)(null),ce=(0,R.useRef)(null),se=(0,R.useState)(!0),de=l()(se,2),fe=de[0],pe=de[1],ve=(0,R.useState)(null),me=l()(ve,2),be=me[0],we=me[1],je=(0,R.useState)({data:[],analyser:null}),ke=l()(je,2),Ce=ke[0],Re=ke[1],Ze=(0,R.useState)(!1),Se=l()(Ze,2),Me=Se[0],Ne=Se[1],Ae=(0,R.useRef)(null),_e=(0,ne.U)(),Pe=_e.updateCancelToken,ze=_e.getCanceltToken,Te=_e.cancelRequest,Ue=(0,ee.Z)(),Ie=Ue.initialize,Ee=Ue.updateScrollerPosition,Le=(0,ee.Z)().initialize;(0,R.useImperativeHandle)(n,(function(){return{viewCode:function(){I(!0)},setCollapse:function(){$(!J)},collapse:J}}));var Fe=function(){s.current=s.current+1},Ye=(0,R.useMemo)((function(){return function(e){var n=e.api,t=e.parameters,r=window.location.origin,a="\ncurl ".concat(r).concat(n,' \\\n-H "Content-Type: multipart/form-data" \\\n-H "Authorization: Bearer ${YOUR_GPUSTACK_API_KEY}" \\\n-F file="@/path/to/file/audio.mp3;type=audio/mpeg" \\\n').concat((0,le.Yy)(t,!0)).trim().replace(/\\$/g,""),u='\nfrom openai import OpenAI\n\naudio_file = open("audio.mp3", "rb")\nclient = OpenAI(\n  base_url="'.concat(r,'/v1-openai", \n  api_key="YOUR_GPUSTACK_API_KEY"\n)\n\nresponse = client.audio.transcriptions.create(\n').concat((0,le.G4)(N()(N()({},t),{},{file:"audio_file"})).replace(/"audio_file"/,"audio_file"),")\n\nprint('response:', response.text)").trim(),i=(0,le.GT)(N()(N()({},t),{},{file:"fs.createReadStream(audio.mp3)"})).replace(/"fs.createReadStream\(audio.mp3\)"/g,'fs.createReadStream("audio.mp3")');return{curlCode:a,pythonCode:u,nodeJsCode:'\nconst fs = require("fs")\nconst OpenAI = require("openai");\n\nconst openai = new OpenAI({\n  "apiKey": "YOUR_GPUSTACK_API_KEY",\n  "baseURL": "'.concat(r,'/v1-openai"\n});\n\nasync function main() {\n  const params = ').concat(i,"; \n  const response = await openai.audio.transcriptions.create(params);\n  console.log(response.text);\n}\n\nmain();").trim()}}({api:"/v1-openai/audio/transcriptions",parameters:N()({},C)})}),[C]),De=function(){var e=i()(a()().mark((function e(){var n,t,r,u,i,o,l,c,d,f,p;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=Ae.current)||void 0===n?void 0:n.form.validateFields();case 2:if(C.model){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,Y(!0),Fe(),H(null),v([]),Te(),Pe(),(0,A.gn)(X.Z["/playground/speech"],!0),t=N()(N()({},C),{},{file:new File([be.data],be.name,{type:be.type})}),e.next=15,(0,S.wE)({data:t},{cancelToken:ze()});case 15:if(!(null!=(r=e.sent)&&r.status_code&&200!==(null==r?void 0:r.status_code)||null!=r&&r.error)){e.next=19;break}return H({error:!0,errorMessage:(null==r||null===(u=r.data)||void 0===u||null===(u=u.error)||void 0===u?void 0:u.message)||(null==r||null===(i=r.error)||void 0===i?void 0:i.message)||(null==r||null===(o=r.data)||void 0===o?void 0:o.message)||(null==r?void 0:r.detail)||""}),e.abrupt("return");case 19:v([{content:r.text,uid:s.current}]),e.next=27;break;case 22:e.prev=22,e.t0=e.catch(4),(null!=(c=null===e.t0||void 0===e.t0||null===(l=e.t0.response)||void 0===l?void 0:l.data)&&c.error||null!=c&&c.status_code&&200!==(null==c?void 0:c.status_code))&&H({error:!0,errorMessage:(null==c||null===(d=c.error)||void 0===d?void 0:d.message)||(null==c||null===(f=c.data)||void 0===f||null===(f=f.error)||void 0===f?void 0:f.message)||(null==c||null===(p=c.data)||void 0===p?void 0:p.error)||(null==c?void 0:c.detail)||""});case 27:return e.prev=27,Y(!1),Ne(!1),(0,A.gn)(X.Z["/playground/speech"],!1),e.finish(27);case 32:case"end":return e.stop()}}),e,null,[[4,22,27,32]])})));return function(){return e.apply(this,arguments)}}(),Oe=(0,R.useCallback)((function(e){we((function(){return{url:e.url,name:e.name,data:e.chunks,type:e.type,duration:e.duration}}))}),[]),qe=(0,R.useCallback)((function(e){pe(e)}),[]),Be=(0,R.useCallback)(function(){var e=i()(a()().mark((function e(n){var t;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re(n.file);case 2:t=e.sent,we(t),H(null);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[]),He=(0,R.useCallback)((function(e,n){Re((function(t){return{data:e,analyser:n}}))}),[]),Ke=(0,R.useCallback)((function(e){Ne(e),we(null),H(null),v([])}),[]),Ge=function(){var e=i()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:De();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,R.useEffect)((function(){te.current&&Ie(te.current)}),[te.current,Ie]),(0,R.useEffect)((function(){ce.current&&Le(ce.current)}),[ce.current,Le]),(0,R.useEffect)((function(){F&&Ee()}),[p,F]),(0,z.jsxs)("div",{className:"ground-left-wrapper",style:{height:"calc(100vh - 72px)"},children:[(0,z.jsxs)("div",{className:"ground-left",children:[(0,z.jsx)("div",{className:"ground-left-footer",style:{flex:1},children:(0,z.jsxs)("div",{className:"speech-to-text",children:[(0,z.jsxs)("div",{className:"speech-box",children:[!Me&&(0,z.jsx)(Q,{type:"default",accept:ie.ql.join(","),onChange:Be}),(0,z.jsx)(he,{type:"default",voiceActivity:!0,onAudioData:Oe,onAudioPermission:qe,onAnalyse:He,onRecord:Ke})]}),be?(0,z.jsxs)("div",{className:"flex-between flex-center justify-center relative",style:{paddingInline:80},children:[(0,z.jsx)("div",{style:{width:600},children:(0,z.jsx)(G,{url:be.url,name:be.name,duration:be.duration})}),(0,z.jsx)("div",{style:{padding:"16px",textAlign:"right",position:"absolute",right:0,top:"50%",transform:"translateY(-50%)"},children:(0,z.jsx)(O.Z,{title:F?u.formatMessage({id:"playground.audio.generating"}):u.formatMessage({id:"playground.audio.button.generate"}),children:(0,z.jsx)(g.ZP,{disabled:!be,loading:F,type:"primary",shape:"circle",onClick:Ge,icon:(0,z.jsx)(ae.Z,{})})})})]}):fe?Me?(0,z.jsx)(U,{fixedHeight:!0,height:82,width:500,analyserData:Ce}):(0,z.jsxs)("div",{className:"tips-text",children:[(0,z.jsx)(c.Z,{type:"icon-audio",style:{fontSize:18}}),(0,z.jsx)("span",{children:u.formatMessage({id:"playground.audio.speechtotext.tips"})})]}):(0,z.jsxs)("div",{className:"tips-text",children:[(0,z.jsx)(c.Z,{type:"icon-audio",style:{fontSize:20}}),(0,z.jsx)("span",{children:u.formatMessage({id:"playground.audio.enablemic"})})]})]})}),(0,z.jsx)("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"space-between",overflow:"auto"},children:(0,z.jsxs)("div",{className:"message-list-wrap",style:{flex:1,position:"relative",borderTop:"1px solid var(--ant-color-split)"},children:[(null==p?void 0:p.length)>0&&(0,z.jsx)("span",{style:{position:"absolute",top:0,right:2},children:(0,z.jsx)(V.Z,{text:null===(t=p[0])||void 0===t?void 0:t.content})}),(0,z.jsx)("div",{className:"content",style:{height:"100%",overflow:"auto"},ref:te,children:(0,z.jsxs)("div",{children:[!B&&(0,z.jsx)("div",{style:{padding:"8px 14px",lineHeight:"20px",display:"flex",justifyContent:"center",wordBreak:"break-word"},children:p.length?null===(r=p[0])||void 0===r?void 0:r.content:(0,z.jsx)("span",{className:"text-tertiary",children:u.formatMessage({id:"playground.audio.generating.tips"})})}),B&&(0,z.jsx)("div",{style:{height:40},children:(0,z.jsx)(_.Z,{type:"danger",message:null==B?void 0:B.errorMessage})})]})}),F&&(0,z.jsx)("div",{style:{width:"100%",flex:1},children:(0,z.jsx)(ue.Z,{size:"small",children:(0,z.jsx)("div",{style:{height:"46px"}})})})]})})]}),(0,z.jsx)("div",{className:j()("params-wrapper",{collapsed:J}),ref:ce,children:(0,z.jsx)("div",{className:"box",children:(0,z.jsx)(xe.Z,{ref:Ae,setParams:Z,paramsConfig:oe.JY,initialValues:ye,params:C,selectedModel:b,modelList:o})})}),(0,z.jsx)(ge.Z,{open:T,viewCodeContent:Ye,onCancel:function(){I(!1)},title:u.formatMessage({id:"playground.viewcode"})})]})})),we=(0,R.memo)(be),je=t(55825),ke=t(95618),Ce=t(2558),Re=t(17098),Ze=t(67825),Se=t.n(Ze),Me=t(21970),Ne=["autoplay","audioUrl","speed"],Ae=(0,R.forwardRef)((function(e,n){var t=e.autoplay,r=e.audioUrl,u=e.speed,o=void 0===u?1:u,l=Se()(e,Ne),c=(0,R.useRef)(null),s=(0,R.useRef)(null),d=(0,R.useRef)(null),f=(0,R.useRef)(null),p=(0,R.useRef)(null),v=(0,R.useRef)(null),m=(0,R.useCallback)((function(){d.current=new(window.AudioContext||window.webkitAudioContext),f.current=d.current.createAnalyser(),f.current.fftSize=512,p.current=new Uint8Array(f.current.frequencyBinCount)}),[]),h=(0,R.useCallback)((function(){d.current.createMediaElementSource(v.current).connect(f.current),f.current.connect(d.current.destination)}),[]),x=(C().debounce((function(){var e,n;null!==(e=c.current)&&void 0!==e&&e.isPlaying()&&(null===(n=c.current)||void 0===n||n.pause())}),100),function(){var n,a,u,i,d,x,g,y,b,w;null===(n=c.current)||void 0===n||n.destroy(),c.current=Me.Z.create(N()({container:s.current,url:r,autoplay:t,audioRate:o,waveColor:"#4096ff",progressColor:"rgb(100, 0, 100)",height:60,barWidth:2,barGap:1,barRadius:2,interact:!0,cursorWidth:0},l)),v.current=null===(a=c.current)||void 0===a?void 0:a.getMediaElement(),m(),h(),null===(u=c.current)||void 0===u||u.on("ready",(function(n){var t;null===(t=e.onReady)||void 0===t||t.call(e,n)})),null===(i=c.current)||void 0===i||i.on("click",(function(n){var t;null===(t=e.onClick)||void 0===t||t.call(e,n)})),null===(d=c.current)||void 0===d||d.on("finish",(function(){var n;null===(n=e.onFinish)||void 0===n||n.call(e)})),null===(x=c.current)||void 0===x||x.on("audioprocess",(function(n){var t;null===(t=e.onAudioprocess)||void 0===t||t.call(e,n)})),null===(g=c.current)||void 0===g||g.on("seeking",(function(e){})),null===(y=c.current)||void 0===y||y.on("timeupdate",(function(e){})),null===(b=c.current)||void 0===b||b.on("play",(function(){var n,t,r;null===(n=f.current)||void 0===n||n.getByteFrequencyData(p.current),null===(t=e.onAnalyse)||void 0===t||t.call(e,p.current,f),null===(r=e.onPlay)||void 0===r||r.call(e)})),null===(w=c.current)||void 0===w||w.on("pause",(function(){var n,t,r;null===(n=f.current)||void 0===n||n.getByteFrequencyData(p.current),null===(t=e.onAnalyse)||void 0===t||t.call(e,p.current,f),null===(r=e.onPause)||void 0===r||r.call(e)}))}),g=function(){var e=i()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.current&&c.current.play();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(){c.current&&c.current.isPlaying()},b=function(){c.current&&c.current.playPause()},w=C().debounce((function(e){c.current&&c.current.seekTo(e)}),50),j=C().debounce((function(e){c.current&&c.current.setTime(e)}),50),k=function(e){c.current&&w(e)},Z=function(e){c.current&&j(e)},S=function(){return c.current?c.current.getDuration():0},M=function(){c.current&&c.current.pause()};return(0,R.useImperativeHandle)(n,(function(){return{play:g,pause:M,duration:S,seekTo:k,setTime:Z,playPause:b,isPlaying:y,wavesurfer:c}})),(0,R.useEffect)((function(){return s.current&&r&&x(),function(){c.current&&c.current.destroy()}}),[r,s.current]),(0,z.jsx)("div",{ref:s,className:"audio-container",style:{display:"none"}})})),_e=R.memo(Ae),Pe=function(e){var n=(0,h.useIntl)(),t=(0,R.useState)(e.autoplay),r=l()(t,2),u=r[0],o=r[1],c=(0,R.useState)(0),s=l()(c,2),d=s[0],f=s[1],p=(0,R.useState)({width:900,height:0}),v=l()(p,2),m=(v[0],v[1]),x=(0,R.useState)(0),y=l()(x,2),b=y[0],w=y[1],j=(0,R.useState)({data:new Uint8Array(128),analyser:null}),Z=l()(j,2),S=Z[0],M=Z[1],A=(0,R.useRef)(null),_=(0,R.useRef)(null),P=(0,R.useCallback)(i()(a()().mark((function e(){var n,t,r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null===(n=_.current)||void 0===n||null===(n=n.wavesurfer.current)||void 0===n||!n.isPlaying()){e.next=7;break}return null===(t=_.current)||void 0===t||t.pause(),o(!1),e.abrupt("return");case 7:return e.next=9,null===(r=_.current)||void 0===r||null===(r=r.wavesurfer.current)||void 0===r?void 0:r.play();case 9:o(!0);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])}))),[_.current]),T=(0,R.useCallback)((function(e,n){M((function(t){return{data:e,analyser:n}}))}),[]),I=(0,R.useCallback)((function(){o(!1)}),[]),E=(0,R.useCallback)((function(){o(!0)}),[]),L=(0,R.useCallback)((function(){o(!1)}),[]),F=(0,k.throttle)((function(e){w(e)}),100),Y=(0,R.useCallback)((function(e){F(e)}),[F]),q=((0,R.useCallback)((function(n){o(e.autoplay),f(n)}),[]),(0,R.useCallback)((function(e){}),[]),(0,R.useCallback)((function(e){m({width:e.width,height:e.height})}),[]),C().debounce((function(e){var n;null===(n=_.current)||void 0===n||n.seekTo(e/d),w(e)}),200)),B=(0,R.useCallback)((function(e){f(e)}),[]),H=((0,R.useCallback)((function(e){var n;null===(n=_.current)||void 0===n||n.seekTo(e/d),w(e)}),[]),(0,R.useCallback)((function(){var n=e.audioUrl||"",t="audio-".concat(de()().format("YYYYMMDDHHmmss"),".").concat(e.format),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),r.remove()}),[e.audioUrl,e.format]));return(0,z.jsxs)("div",{children:[(0,z.jsx)("div",{className:"speech-item",children:(0,z.jsxs)("div",{className:"wrapper",style:{height:120,width:"100%"},ref:A,children:[(0,z.jsx)(_e,N()(N()({},e),{},{audioUrl:e.audioUrl,onReady:B,onFinish:I,onPlay:E,onPause:L,onAnalyse:T,onAudioprocess:Y,ref:_})),u&&(0,z.jsx)(U,{maxBarCount:100,amplitude:60,fixedHeight:!0,height:120,width:800,analyserData:S})]})}),(0,z.jsx)(D.Z,{className:"slider-progress",value:b,max:d,step:.01,onChange:function(e){q(e)}}),(0,z.jsxs)("div",{className:"speech-actions",children:[(0,z.jsx)("span",{className:"tags",children:(0,z.jsx)("span",{className:"item",children:e.format})}),(0,z.jsx)("span",{className:"duration",children:C().round(b,2)||C().round(d,2)}),(0,z.jsxs)("div",{className:"actions",children:[(0,z.jsx)(O.Z,{title:u?n.formatMessage({id:"playground.audio.button.stop"}):n.formatMessage({id:"playground.audio.button.play"}),children:(0,z.jsx)(g.ZP,{disabled:!e.audioUrl||0===d,onClick:P,icon:u?(0,z.jsx)(ke.Z,{className:"font-size-16"}):(0,z.jsx)(Ce.Z,{className:"font-size-16"}),type:"text",size:"small"})}),(0,z.jsx)(O.Z,{title:n.formatMessage({id:"playground.audio.button.download"}),children:(0,z.jsx)(g.ZP,{disabled:!e.audioUrl||0===d,onClick:H,icon:(0,z.jsx)(Re.Z,{className:"font-size-16"}),type:"text",size:"small"})})]})]})]})},ze=R.memo(Pe),Te=function(e){return(0,z.jsx)(z.Fragment,{children:e.dataList.map((function(e){return(0,z.jsx)(ze,N()({},e),e.uid)}))})},Ue=R.memo(Te),Ie=t(68476),Ee=t(19427),Le={voice:"",response_format:"mp3"},Fe=(0,R.forwardRef)((function(e,n){var t=e.modelList,r=(0,R.useRef)(0),u=(0,R.useState)([]),o=l()(u,2),s=o[0],d=o[1],f=(0,h.getLocale)(),p=(0,h.useIntl)(),v=(0,h.useSearchParams)(),m=l()(v,1)[0],x=m.get("type")||"",g=m.get("model")?"tts"===x&&m.get("model"):"",y=(0,R.useState)({}),b=l()(y,2),w=b[0],k=b[1],Z=(0,R.useState)(!1),M=l()(Z,2),P=M[0],T=M[1],U=(0,R.useState)(!1),I=l()(U,2),E=I[0],L=I[1],F=(0,R.useState)(null),Y=l()(F,2),D=Y[0],O=Y[1],q=(0,R.useState)(null),B=l()(q,2),H=B[0],K=(B[1],(0,R.useState)(!1)),G=l()(K,2),V=G[0],W=G[1],J=(0,R.useRef)(null),$=(0,R.useRef)(null),Q=(0,R.useRef)(null),ne=(0,R.useRef)(0),te=(0,R.useRef)(!0),re=(0,R.useState)(""),ie=l()(re,2),ce=ie[0],se=ie[1],de=(0,R.useState)([]),fe=l()(de,2),pe=fe[0],ve=fe[1],me=(0,R.useRef)(null),he=(0,ee.Z)(),ye=he.initialize,be=he.updateScrollerPosition,we=(0,ee.Z)().initialize;(0,R.useImperativeHandle)(n,(function(){return{viewCode:function(){T(!0)},setCollapse:function(){W(!V)},collapse:V}}));var ke=(0,R.useMemo)((function(){return function(e){var n=e.api,t=e.parameters,r=window.location.origin,a="\ncurl ".concat(r).concat(n,' \\\n-H "Content-Type: multipart/form-data" \\\n-H "Authorization: Bearer ${YOUR_GPUSTACK_API_KEY}" \\\n').concat((0,le.Yy)(t,!1)," \\\n--output output.").concat(t.response_format).trim(),u='\nfrom pathlib import Path\nfrom openai import OpenAI\n\noutput_file_path = Path(__file__).parent / "output.mp3"\nclient = OpenAI(\n  base_url="'.concat(r,'/v1-openai", \n  api_key="YOUR_GPUSTACK_API_KEY"\n)\n\nresponse = client.audio.speech.create(\n').concat((0,le.G4)(N()({},t)),')\n\nwith open(output_file_path, "wb") as f:\n    for chunk in response.iter_bytes(): \n        f.write(chunk)\n\nprint(f"Audio saved to {output_file_path}")').trim(),i=(0,le.GT)(N()({},t));return{curlCode:a,pythonCode:u,nodeJsCode:'\nconst fs = require("fs");\nconst path = require("path");\nconst OpenAI = require("openai");\n\nconst ouptFile = path.resolve("./output.mp3");\n\nconst openai = new OpenAI({\n  "apiKey": "YOUR_GPUSTACK_API_KEY",\n  "baseURL": "'.concat(r,'/v1-openai"\n});\n\nasync function main() {\n  const params = ').concat(i,"; \n  const response = await openai.audio.speech.create(params);\n  console.log(ouptFile);\n  const buffer = Buffer.from(await response.arrayBuffer());\n  await fs.promises.writeFile(ouptFile, buffer);\n}\nmain();").trim()}}({api:"/v1-openai/audio/speech",parameters:N()(N()({},w),{},{input:ce})})}),[w,ce]),Ce=(0,R.useCallback)((function(e,n){var t="en-US"===e?"english":"chinese";return n.sort((function(e,n){var r=e.value.toLowerCase().includes(t)?1:0;return(n.value.toLowerCase().includes(t)?1:0)-r}))}),[]),Re=(0,R.useMemo)((function(){return pe.length?Ce(f,pe):[]}),[f,pe,Ce]);(0,R.useEffect)((function(){var e,n,t=Ce(f,pe);k((function(e){var n;return N()(N()({},e),{},{voice:null===(n=t[0])||void 0===n?void 0:n.value})})),null===(e=me.current)||void 0===e||e.form.setFieldValue("voice",null===(n=t[0])||void 0===n?void 0:n.value)}),[f,pe,Ce]);var Ze=function(){r.current=r.current+1},Se=function(){var e=i()(a()().mark((function e(n){var t,u,i,o,l,c,s,f,p,v,m,h,x,g;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=me.current)||void 0===t?void 0:t.form.validateFields();case 2:if(w.model){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,L(!0),Ze(),O(null),se((null==n?void 0:n.content)||""),d([]),(0,A.gn)(X.Z["/playground/speech"],!0),null===(u=J.current)||void 0===u||null===(i=u.abort)||void 0===i||i.call(u),J.current=new AbortController,o=J.current.signal,l=N()(N()({},w),{},{input:(null==n?void 0:n.content)||ce}),e.next=17,(0,S.jQ)({data:l,url:S.qt,signal:o});case 17:if(!(null!=(c=e.sent)&&c.status_code&&200!==(null==c?void 0:c.status_code)||null!=c&&c.error)){e.next=23;break}return O({error:!0,errorMessage:(null==c||null===(s=c.data)||void 0===s||null===(s=s.error)||void 0===s?void 0:s.message)||(null==c||null===(f=c.error)||void 0===f?void 0:f.message)||(null==c||null===(p=c.data)||void 0===p?void 0:p.error)||(null==c?void 0:c.detail)||""}),d([]),e.abrupt("return");case 23:d([{input:(null==n?void 0:n.content)||ce,voice:w.voice,format:w.response_format,speed:w.speed,uid:r.current,autoplay:te.current,audioUrl:c.url}]),e.next=31;break;case 26:e.prev=26,e.t0=e.catch(4),null!=(m=null===e.t0||void 0===e.t0||null===(v=e.t0.response)||void 0===v?void 0:v.data)&&m.error&&O({error:!0,errorMessage:(null==m||null===(h=m.error)||void 0===h?void 0:h.message)||(null==m||null===(x=m.data)||void 0===x||null===(x=x.error)||void 0===x?void 0:x.message)||(null==m||null===(g=m.data)||void 0===g?void 0:g.error)||(null==m?void 0:m.detail)||""});case 31:return e.prev=31,L(!1),(0,A.gn)(X.Z["/playground/speech"],!1),e.finish(31);case 35:case"end":return e.stop()}}),e,null,[[4,26,31,35]])})));return function(n){return e.apply(this,arguments)}}(),Me=(0,R.useCallback)(function(){var e=i()(a()().mark((function e(n){var r,u,i,o,l,c,s;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=5;break}return ve([]),k((function(e){return N()(N()({},e),{},{voice:""})})),null===(o=me.current)||void 0===o||o.form.setFieldValue("voice",""),e.abrupt("return");case 5:l=t.find((function(e){return e.value===n})),c=C().map((null==l||null===(r=l.meta)||void 0===r?void 0:r.voices)||[],(function(e){return{label:e,value:e}})),s=Ce(f,c),ve(s),k((function(e){var n;return N()(N()({},e),{},{voice:null===(n=s[0])||void 0===n?void 0:n.value})})),null===(u=me.current)||void 0===u||u.form.setFieldValue("voice",null===(i=s[0])||void 0===i?void 0:i.value);case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[t]),Ne=(0,R.useMemo)((function(){return oe.I_.map((function(e){return(0,z.jsx)(Ie.Z.Item,{name:e.name,rules:e.rules,children:(0,z.jsx)(je.Z,N()(N()({},e.attrs),{},{options:"voice"===e.name?Re:e.options,label:e.label.isLocalized?p.formatMessage({id:e.label.text}):e.label.text}))},e.name)}))}),[oe.I_,p,Re]),Ae=(0,R.useMemo)((function(){return H?(0,z.jsx)(z.Fragment,{children:H&&(0,z.jsx)("div",{style:{height:40},children:(0,z.jsx)(_.Z,{type:"danger",ellipsis:!1,style:{textAlign:"left"},message:p.formatMessage({id:"playgorund.audio.voice.error"})})})}):null}),[H]);return(0,R.useEffect)((function(){Me(w.model)}),[w.model,Me]),(0,R.useEffect)((function(){$.current&&ye($.current)}),[$.current,ye]),(0,R.useEffect)((function(){Q.current&&we(Q.current)}),[Q.current,we]),(0,R.useEffect)((function(){E&&be()}),[s,E]),(0,R.useEffect)((function(){s.length>ne.current&&be(),ne.current=s.length}),[s.length]),(0,z.jsxs)("div",{className:"ground-left-wrapper",children:[(0,z.jsxs)("div",{className:"ground-left",children:[(0,z.jsx)("div",{className:"message-list-wrap",children:(0,z.jsx)("div",{style:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,z.jsxs)("div",{className:"content",style:{maxWidth:1e3},children:[s.length?(0,z.jsx)(Ue,{dataList:s,loading:E}):(0,z.jsxs)("div",{className:"flex-column font-size-14 flex-center gap-20",children:[(0,z.jsx)("span",{children:(0,z.jsx)(c.Z,{type:"icon-audio ",className:"font-size-32 text-secondary"})}),(0,z.jsx)("span",{children:p.formatMessage({id:"playground.audio.texttospeech.tips"})})]}),E&&(0,z.jsx)(ue.Z,{size:"small",children:(0,z.jsx)("div",{style:{height:"46px"}})})]})})}),D&&(0,z.jsx)("div",{style:{height:40},children:(0,z.jsx)(_.Z,{type:"danger",message:null==D?void 0:D.errorMessage})}),(0,z.jsx)("div",{className:"ground-left-footer",children:(0,z.jsx)(Ee.Z,{actions:["check","clear"],checkLabel:p.formatMessage({id:"playground.toolbar.autoplay"}),placeholer:p.formatMessage({id:"playground.input.text.holder"}),defaultSize:{minRows:5,maxRows:5},title:(0,z.jsx)("span",{className:"font-600",children:p.formatMessage({id:"playground.audio.textinput"})}),onCheck:function(e){te.current=e.target.checked},loading:E,disabled:!w.model,isEmpty:!0,handleSubmit:function(e){Se(e)},handleAbortFetch:function(){var e,n;null===(e=J.current)||void 0===e||null===(n=e.abort)||void 0===n||n.call(e),L(!1)},onInputChange:function(e){se(e.target.value)},clearAll:function(){Ze(),d([]),O(null)},shouldResetMessage:!1,submitIcon:(0,z.jsx)(ae.Z,{})})})]}),(0,z.jsx)("div",{className:j()("params-wrapper",{collapsed:V}),ref:Q,children:(0,z.jsx)("div",{className:"box",children:(0,z.jsx)(xe.Z,{ref:me,setParams:k,initialValues:Le,params:w,selectedModel:g,modelList:t,extra:[Ne,Ae]})})}),(0,z.jsx)(ge.Z,{open:P,viewCodeContent:ke,onCancel:function(){T(!1)},title:p.formatMessage({id:"playground.viewcode"})})]})})),Ye=(0,R.memo)(Fe),De=(t(64232),"tts"),Oe="stt",qe=function(){var e=(0,h.useIntl)(),n=(0,h.useSearchParams)(),t=l()(n,1)[0].get("type")||"",r=(0,f.Z)().size,u=(0,R.useState)(t||De),o=l()(u,2),w=o[0],k=o[1],M=(0,R.useRef)(null),N=(0,R.useRef)(null),A=(0,R.useState)([]),_=l()(A,2),P=_[0],T=_[1],U=(0,R.useState)([]),I=l()(U,2),E=I[0],L=I[1],F=(0,R.useState)(!1),Y=l()(F,2),D=Y[0],O=Y[1],q=[{label:e.formatMessage({id:"playground.audio.texttospeech"}),value:De,icon:(0,z.jsx)(c.Z,{type:"icon-audio"})},{label:e.formatMessage({id:"playground.audio.speechtotext"}),value:Oe,icon:(0,z.jsx)(v.Z,{})}],B=(0,R.useCallback)((function(){var e,n;if(w===De)null===(e=M.current)||void 0===e||null===(n=e.viewCode)||void 0===n||n.call(e);else if(w===Oe){var t,r;null===(t=N.current)||void 0===t||null===(r=t.viewCode)||void 0===r||r.call(t)}}),[w]),H=(0,R.useCallback)((function(){var e,n,t,r;w!==De?null===(e=N.current)||void 0===e||null===(n=e.setCollapse)||void 0===n||n.call(e):null===(t=M.current)||void 0===t||null===(r=t.setCollapse)||void 0===r||r.call(t)}),[w]),K=[{key:"tts",label:"TTS",children:(0,z.jsx)(Ye,{ref:M,modelList:P})},{key:"stt",label:"Realtime",children:(0,z.jsx)(we,{modelList:E,loaded:D,ref:N})}];(0,R.useEffect)((function(){var e,n,t;r.width<s.Z.lg&&(null!==(e=M.current)&&void 0!==e&&e.collapse||null===(n=M.current)||void 0===n||null===(t=n.setCollapse)||void 0===t||t.call(n))}),[r.width]),(0,R.useEffect)((function(){var e=function(){var e=i()(a()().mark((function e(){var n,t,r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={categories:p.Us.text_to_speech,with_meta:!0},e.next=4,(0,S.nb)(n);case 4:return t=e.sent,r=C().map(t.data||[],(function(e){return{value:e.id,label:e.id,meta:e.meta}})),e.abrupt("return",r);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),n=function(){var e=i()(a()().mark((function e(){var n,t,r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={categories:p.Us.speech_to_text,with_meta:!0},e.next=4,(0,S.nb)(n);case 4:return t=e.sent,r=C().map(t.data||[],(function(e){return{value:e.id,label:e.id,meta:e.meta}})),e.abrupt("return",r);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),t=function(){var t=i()(a()().mark((function t(){var r,u,i,o;return a()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Promise.all([e(),n()]);case 3:r=t.sent,u=l()(r,2),i=u[0],o=u[1],T(i),L(o),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),O(!0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(){return t.apply(this,arguments)}}();t()}),[]);return(0,Z.y1)(d.ZP.RIGHT.join(","),(function(){var e,n;null===(e=M.current)||void 0===e||null===(n=e.setCollapse)||void 0===n||n.call(e)}),{preventDefault:!0}),(0,z.jsx)(m._z,{ghost:!0,header:{title:(0,z.jsxs)("div",{className:"flex items-center",children:[(0,z.jsx)("span",{className:"font-600",children:e.formatMessage({id:"menu.playground.speech"})}),(0,z.jsx)(y.Z,{options:q,size:"middle",className:"m-l-40",value:w,onChange:function(e){return k(e)}})]}),breadcrumb:{}},extra:(0,z.jsxs)(x.Z,{children:[(0,z.jsx)(g.ZP,{size:"middle",onClick:B,icon:(0,z.jsx)(c.Z,{type:"icon-code",className:"font-size-16"}),children:e.formatMessage({id:"playground.viewcode"})}),(0,z.jsx)(g.ZP,{size:"middle",onClick:H,icon:(0,z.jsx)(c.Z,{type:"icon-a-layout6-line",className:"font-size-16"})})]},"buttons"),className:j()("playground-container",{compare:"compare"===w,chat:"compare"!==w}),children:(0,z.jsx)("div",{className:"play-ground",children:(0,z.jsx)("div",{className:"chat",children:(0,z.jsx)(b.Z,{items:K,activeKey:w})})})})}}}]);